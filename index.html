<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>3D 图片查看器</title>
  <style>
    @import url("https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&display=swap");

    :root {
      --bg-a: #0e1324;
      --bg-b: #202b4b;
      --accent: #ffb347;
      --accent-2: #7ae7ff;
      --text: #f3f5ff;
      --panel: rgba(255, 255, 255, 0.08);
      --shadow: rgba(0, 0, 0, 0.45);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: "Space Grotesk", "Noto Sans CJK SC", "PingFang SC", sans-serif;
      color: var(--text);
      background: radial-gradient(1200px 600px at 10% 10%, #2c3b66 0%, transparent 60%),
        radial-gradient(900px 500px at 90% 20%, #27304d 0%, transparent 55%),
        linear-gradient(160deg, var(--bg-a), var(--bg-b));
      overflow: hidden;
    }

    .glow {
      position: fixed;
      inset: auto 10% 10% auto;
      width: 260px;
      height: 260px;
      background: radial-gradient(circle, rgba(255, 179, 71, 0.5), transparent 65%);
      filter: blur(10px);
      opacity: 0.8;
      pointer-events: none;
      animation: float 10s ease-in-out infinite;
    }

    @keyframes float {
      0% { transform: translateY(0px); }
      50% { transform: translateY(-20px); }
      100% { transform: translateY(0px); }
    }

    .layout {
      display: grid;
      grid-template-columns: 360px 1fr;
      gap: 24px;
      height: 100vh;
      padding: 32px;
    }

    .panel {
      background: var(--panel);
      border: 1px solid rgba(255, 255, 255, 0.12);
      border-radius: 20px;
      padding: 24px;
      backdrop-filter: blur(12px);
      box-shadow: 0 20px 60px var(--shadow);
    }

    .panel h1 {
      margin: 0 0 12px;
      font-size: 28px;
      letter-spacing: 0.02em;
    }

    .panel p {
      margin: 0 0 20px;
      opacity: 0.8;
      line-height: 1.5;
    }

    .controls {
      display: grid;
      gap: 12px;
    }

    .controls label {
      font-size: 14px;
      opacity: 0.8;
    }

    .controls input[type="range"] {
      width: 100%;
    }

    .controls input[type="file"] {
      padding: 10px;
      border-radius: 12px;
      border: 1px dashed rgba(255, 255, 255, 0.3);
      background: rgba(0, 0, 0, 0.2);
      color: var(--text);
    }

    .button-row {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    button {
      border: 0;
      border-radius: 999px;
      padding: 10px 16px;
      font-weight: 600;
      color: #0b0f1d;
      background: linear-gradient(120deg, var(--accent), var(--accent-2));
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    button:hover {
      transform: translateY(-2px) scale(1.01);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.25);
    }

    .stage {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 24px;
      background: rgba(8, 12, 24, 0.6);
      border: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow: inset 0 0 120px rgba(0, 0, 0, 0.6), 0 40px 80px var(--shadow);
      overflow: hidden;
    }

    .stage::before {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(90deg, rgba(255, 255, 255, 0.08), transparent 40%, rgba(255, 255, 255, 0.05));
      pointer-events: none;
      mix-blend-mode: screen;
    }

    .viewer {
      position: relative;
      width: min(70vw, 720px);
      height: min(70vh, 560px);
      transform-style: preserve-3d;
      perspective: 1400px;
      display: grid;
      place-items: center;
    }

    .card {
      width: 100%;
      height: 100%;
      border-radius: 24px;
      transform-style: preserve-3d;
      background: #0f1528;
      box-shadow: 0 25px 60px rgba(0, 0, 0, 0.45);
      transition: transform 0.2s ease;
      position: relative;
      overflow: hidden;
    }

    .card img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .card .gloss {
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at var(--mx, 50%) var(--my, 50%), rgba(255, 255, 255, 0.3), transparent 55%);
      mix-blend-mode: screen;
      opacity: 0.8;
      pointer-events: none;
      transition: opacity 0.2s ease;
    }

    .hint {
      position: absolute;
      bottom: 16px;
      right: 20px;
      font-size: 12px;
      opacity: 0.6;
    }

    @media (max-width: 980px) {
      .layout {
        grid-template-columns: 1fr;
        padding: 20px;
      }

      .panel {
        order: 2;
      }

      .stage {
        order: 1;
        min-height: 60vh;
      }
    }
  </style>
</head>
<body>
  <div class="glow"></div>
  <div class="layout">
    <section class="panel">
      <h1>3D 图片查看器</h1>
      <p>拖拽旋转、滚轮缩放，像在空间里“摸”图片。你也可以上传自己的图片。</p>
      <div class="controls">
        <label>上传图片</label>
        <input id="fileInput" type="file" accept="image/*" />

        <label for="tilt">倾斜强度</label>
        <input id="tilt" type="range" min="5" max="40" value="18" />

        <label for="depth">纵深</label>
        <input id="depth" type="range" min="0" max="200" value="40" />

        <div class="button-row">
          <button id="resetBtn">重置视角</button>
          <button id="autoBtn">自动旋转</button>
        </div>
      </div>
    </section>

    <section class="stage">
      <div class="viewer" id="viewer">
        <div class="card" id="card">
          <img id="image" src="https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?auto=format&fit=crop&w=1200&q=80" alt="3D preview" />
          <div class="gloss"></div>
        </div>
      </div>
      <div class="hint">拖拽 / 滚轮 / 双击</div>
    </section>
  </div>

  <script>
    const viewer = document.getElementById("viewer");
    const card = document.getElementById("card");
    const gloss = card.querySelector(".gloss");
    const image = document.getElementById("image");
    const fileInput = document.getElementById("fileInput");
    const tiltInput = document.getElementById("tilt");
    const depthInput = document.getElementById("depth");
    const resetBtn = document.getElementById("resetBtn");
    const autoBtn = document.getElementById("autoBtn");

    let rotateX = 0;
    let rotateY = 0;
    let zoom = 1;
    let isDragging = false;
    let startX = 0;
    let startY = 0;
    let autoRotate = false;
    let autoFrame = null;

    function applyTransform() {
      const depth = Number(depthInput.value);
      card.style.transform = `rotateX(${rotateX}deg) rotateY(${rotateY}deg) translateZ(${depth}px) scale(${zoom})`;
    }

    function setGloss(x, y) {
      card.style.setProperty("--mx", `${x}%`);
      card.style.setProperty("--my", `${y}%`);
    }

    viewer.addEventListener("mousedown", (event) => {
      isDragging = true;
      startX = event.clientX;
      startY = event.clientY;
    });

    window.addEventListener("mouseup", () => {
      isDragging = false;
    });

    window.addEventListener("mousemove", (event) => {
      const rect = viewer.getBoundingClientRect();
      const xPercent = ((event.clientX - rect.left) / rect.width) * 100;
      const yPercent = ((event.clientY - rect.top) / rect.height) * 100;
      setGloss(xPercent, yPercent);

      if (!isDragging) return;
      const tilt = Number(tiltInput.value);
      const deltaX = event.clientX - startX;
      const deltaY = event.clientY - startY;
      rotateY += (deltaX / rect.width) * tilt;
      rotateX -= (deltaY / rect.height) * tilt;
      startX = event.clientX;
      startY = event.clientY;
      applyTransform();
    });

    viewer.addEventListener("wheel", (event) => {
      event.preventDefault();
      const delta = Math.sign(event.deltaY);
      zoom = Math.min(1.8, Math.max(0.6, zoom - delta * 0.05));
      applyTransform();
    }, { passive: false });

    viewer.addEventListener("dblclick", () => {
      rotateX = 0;
      rotateY = 0;
      zoom = 1;
      applyTransform();
    });

    fileInput.addEventListener("change", (event) => {
      const file = event.target.files[0];
      if (!file) return;
      const url = URL.createObjectURL(file);
      image.src = url;
    });

    resetBtn.addEventListener("click", () => {
      rotateX = 0;
      rotateY = 0;
      zoom = 1;
      applyTransform();
    });

    function runAutoRotate() {
      autoFrame = requestAnimationFrame(() => {
        rotateY += 0.2;
        rotateX = Math.sin(Date.now() / 1200) * 6;
        applyTransform();
        if (autoRotate) runAutoRotate();
      });
    }

    autoBtn.addEventListener("click", () => {
      autoRotate = !autoRotate;
      autoBtn.textContent = autoRotate ? "停止旋转" : "自动旋转";
      if (autoRotate) {
        runAutoRotate();
      } else if (autoFrame) {
        cancelAnimationFrame(autoFrame);
      }
    });

    applyTransform();
  </script>
</body>
</html>
